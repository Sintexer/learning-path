# S3

1. Block stores:
	1. EBS.
	2. EC2 instance store.
2. File store (EFS - Elastic file system).
3. Object stores:
	1. S3.
	2. Glacier.

## EBS

Could be **SSD** or **HDD** backed. SSD: gp3, gp2, io1, io2. HDD: st1, sc1.

**EBS snapshots best practices:**

1. Incremental (only changed should be snapped).
2. Could be done during instance running, but better not to do it during high load.
3. Max 100\_000 snapshots.
4. Can be duplicated acros AZ.
5. Should be warmed up after unsealing.
6. Could be automated using AWS Lifecycle management.
7. You can make AMI from snapshot.
8. Snapshots are stored in S3.

**EBS Ecnryption:**

1. Everything is encrypted (volume, data transfered between volume and instance, snapshots, volumes from snapshots).
2. Encryption is transparent, without your efforts.
3. Low impact on latency.
4. KMS keys could be used.
5. Snapshots of encrypted volumes are encrypted.

**EBS Migration:**

1. EBS volumes are locked to specific AZ.
2. To migrate you need to make snapshot, copy snapshot to different AZ, unseal snapshot.

**EBS vs Instance store:**

Instance store is physically attached to the machine, while EBS volume is a network drive.

`+` Instance store has better perfomance.
`+` Good for buffer/cache/scratch data/temporary content.
`+` Data survives reboot.

`-` On *stop* or *termination* instance store is lost.
`-` You can't resize the instance store.
`-` backups *must* be operated by user.

**Use cases:**

- `gp2` and `gp3` (General Purpose `SSD`) balance price and performance. Are ideal for use cases such as
boot volumes, medium-size single instance databases, and development and test environments.
- `io1` and `io2` (Provisioned IOPS `SSD`) support up to 64,000 IOPS and 1,000 MiB/s of throughput. This
enables you to predictably scale to tens of thousands of IOPS per EC2 instance.
- `st1` (Throughput Optimized `HDD`) low-cost storage that defines performance in terms of throughput
rather than IOPS. These volumes are ideal for large, sequential workloads such as Amazon EMR, ETL, data
warehouses, and log processing.
- `sc1` (Cold HDD) provide low-cost magnetic storage that defines performance in terms of throughput rather
than IOPS. These volumes are ideal for large, sequential, cold-data workloads. If you require **infrequent
access** to your data and are looking to save costs, these volumes provide inexpensive block storage.

## EFS

You can mount EFS volume to different AWS networks and devices, could be mounted to several AZ. Uses NFSv4 protocol.

Two starage classes:
- **Standard access** - for frequently accessed files.
- **Infrequent access (EFS IA)** - for long-lived but less ised files at lower cost.

**Key features:**

1. **Shared storage** - files could be access either from AWS or from on-premises. Could be accessed by thousands of EC2 instances with different technologies (from VPN, AWS Direct connect etc.) - good for hybrid solutions. Multiple AZ and Regions.
2. **Scalable perfomance** - EFS designed for low latency IOPS. As storage size grows - perfomance increases. 10GB/s at peek with 500k IOPS. EFS scales automatically.
3. **Secure and compliant** - EFS can be used with IAM roles as well as VPC security groups and allows you to define individual file permissions using POSIX. EFS has built-in compliance with common regulatory standards, including PCI DSS, HIPAA, and SOC with the ability to meet others if necessary.

**EFS Backup solutions:**

1. **AWS Backup** - backups could only be stored on AWS, requires you to manually pause the applications. But it is easy to implement, low cost, fully managed service, incremental, schedualble. This system is PCI and ISO compliant and HIPAA eligible, to ensure that your compliance needs are covered. It is possible to use AWS Backup whether your system has a cloud-native, hybrid, or on-premise configuration.
2. **There is no built-in EFS backup** - EFS also doesn't have native snapshot mechanism. Considered as EFS to EFS back ups. It is a special pipeline through a template in AWS CloudFormation.
3. **Backing up your data to S3** - you need programming abilities to do that and back ups are not incremental.

EFS is elastic and permanent. But there are no Windows instances and no system boot volumes. 

EFS is suitable for:

1. Web serving.
2. Enterprise app usage.
3. Media and entartainment.
4. Shared and home directories.
5. DB backups.
6. Big data analytics.

You pay for the storage used only.


